## HashMap

### 特性
- 允许null值
- 非线程安全
- 当链表长度大于等于 8，并且整个数组大小大于 64 时，会转成红黑树

### 问题
问：为什么数组大于8才进行扩容

答：让 HashMap 仍然有较高的查询性能，参考了泊松分布概率函数，认为链表的长度不可能到达 8

### 红黑树特性
- 1、节点是红色或黑色
- 2、根是黑色
- 3、所有叶子都是黑色
- 4、从任一节点到其每个叶子的所有简单路径都包含相同数目的黑色节点
- 5、从每个叶子到根的所有路径上不能有两个连续的红色节点

### HashMap查找过程
#### 链表查找过程
- 判断节点hash是否等于key的hash，并且equals相等，则该节点是要找的节点
- 否则，把当前节点的下一个节点拿出来继续寻找

#### 红黑树查找过程
- 从根节点递归查找;
- 根据 hashcode，比较查找节点，左边节点，右边节点之间的大小，根本红黑树左小右大
的特性进行判断;
- 判断查找节点在第 2 步有无定位节点位置，有的话返回，没有的话重复 2，3 两步;
- 一直自旋到定位到节点位置为止。

### 新增
#### 链表的新增
链表的新增比较简单，就是把当前节点追加到链表的尾部，和 LinkedList 的追加实现一样的

#### 红黑树的新增
具体看java.util.HashMap.TreeNode.putTreeVal方法


### Hash冲突解决方法
- 使用好的Hash方法
- 自动扩容
- 发生冲突时采用链表解决
- 自动转换为红黑树，提高遍历速度

### 扩容
- 扩容时机：
    - 初始化时，数组为空，扩容为16
    - 数组大小大于阈值
- 阈值大小=数组大小*负载因子（0.75），每次扩容会被重新计算       